{"visual":{"name":"arcDiagram","displayName":"arcDiagram","guid":"arcDiagram3AE23BF6D2F64FC8B1ACABEBAD0FAE26_DEBUG","visualClassName":"Visual","version":"1.0.0","description":"","supportUrl":"","gitHubUrl":""},"author":{"name":"","email":""},"apiVersion":"1.13.0","style":"style/visual.less","capabilities":{"dataRoles":[{"displayName":"Values","kind":"GroupingOrMeasure","name":"Values"}],"dataViewMappings":[{"scriptResult":{"dataInput":{"table":{"rows":{"select":[{"for":{"in":"Values"}}],"dataReductionAlgorithm":{"top":{}}}}},"script":{"scriptProviderDefault":"R","scriptOutputType":"html","source":{"objectName":"rcv_script","propertyName":"source"},"provider":{"objectName":"rcv_script","propertyName":"provider"},"scriptSourceDefault":"#setwd(\"C:/Data/pbiViz/arcdiagram/\")\r\n############### Utility functions ###############\nlibraryRequireInstall = function(packageName, ...)\n{\n  if(!require(packageName, character.only = TRUE)) \n    warning(paste(\"*** The package: '\", packageName, \"' was not installed ***\", sep=\"\"))\n}\n\nlibraryRequireInstall(\"XML\")\nlibraryRequireInstall(\"htmlwidgets\")\n\ninternalSaveWidget <- function(widget, fname)\n{\n  tempFname = paste(fname, \".tmp\", sep=\"\")\n  htmlwidgets::saveWidget(widget, file = tempFname, selfcontained = FALSE)\n  FlattenHTML(tempFname, fname)\n}\n\nFlattenHTML <- function(fnameIn, fnameOut)\n{\n  # Read and parse HTML file\n  # Embed all js and css files into one unified file\n  \n  if(!file.exists(fnameIn))\n    return(FALSE)\n  \n  dir = dirname(fnameIn)\n  html = htmlTreeParse(fnameIn, useInternal = TRUE)\n  top = xmlRoot(html)\n  \n  # extract all <script> tags with src value\n  srcNode=getNodeSet(top, '//script[@src]')\n  for (node in srcNode)\n  {\n    b = xmlAttrs(node)\n    fname = file.path(dir, b['src'])\n    alternateSrc = FindSrcReplacement(fname)\n    if (!is.null(alternateSrc))\n    {\n      s = alternateSrc\n      names(s) = 'src'\n      newNode = xmlNode(\"script\",attrs = s)\n      replaceNodes(node, newNode)\n    }else{\n      str=ReadFileForEmbedding(fname);\n      if (!is.null(str))\n      {      \n        newNode = xmlNode(\"script\", str, attrs = c(type = \"text/javascript\"))\n        replaceNodes(node, newNode)\n      }\n    }\n  }\n  \n  # extract all <link> tags with src value\n  linkNode=getNodeSet(top, '//link[@href]')\n  for (node in linkNode)\n  {\n    b = xmlAttrs(node)\n    fname = file.path(dir, b['href'])\n    str = ReadFileForEmbedding(fname, FALSE);\n    if (!is.null(str))\n    {\n      newNode = xmlNode(\"style\", str)\n      replaceNodes(node, newNode)\n    }\n  }\n  \n  saveXML(html, file = fnameOut)\n  return(TRUE)\n}\n\nReadFileForEmbedding <- function(fname, addCdata = TRUE)\n{\n  data = ReadFullFile(fname)\n  if (is.null(data))\n    return(NULL)\n\n  str = paste(data, collapse ='\\n')\n  if (addCdata) {\n    str = paste(cbind('// <![CDATA[', str,'// ]]>'), collapse ='\\n')\n  }\n  return(str)\n}\n\nReadFullFile <- function(fname)\n{\n  if(!file.exists(fname))\n    return(NULL)\n  \n  con = file(fname, open = \"r\")\n  data = readLines(con)\n  close(con)\n  return(data)\n}\n\nFindSrcReplacement <- function(str)\n{\n  # finds reference to 'plotly' js and replaces with a version from CDN\n  # This allows the HTML to be smaller, since this script is not fully embedded in it\n  str <- iconv(str, to=\"UTF-8\")\n  pattern = \"plotlyjs-(\\\\w.+)/plotly-latest.min.js\"\n  match1=regexpr(pattern, str)\n  attr(match1, 'useBytes') <- FALSE\n  strMatch=regmatches(str, match1, invert = FALSE)\n  if (length(strMatch) == 0) return(NULL)\n  \n  pattern2 = \"-(\\\\d.+)/\"\n  match2 = regexpr(pattern2, strMatch[1])\n  attr(match2, 'useBytes') <- FALSE\n  strmatch = regmatches(strMatch[1], match2)\n  if (length(strmatch) == 0) return(NULL)\n  \n  # CDN url is https://cdn.plot.ly/plotly-<Version>.js\n  # This matches the specific version used in the plotly package used.\n  verstr = substr(strmatch, 2, nchar(strmatch)-1)\n  str = paste('https://cdn.plot.ly/plotly-', verstr,'.min.js', sep='')\n  return(str)\n}\n#################################################\n\r\n\r\nlibraryRequireInstall(\"magrittr\")\r\nlibraryRequireInstall(\"tibble\")\r\nlibraryRequireInstall(\"RColorBrewer\")\r\nlibraryRequireInstall(\"plotly\")\r\nlibraryRequireInstall(\"dplyr\")\r\n\r\ncolor.gradient <- function(x, colors=c(\"#c9cba3\",\"#ffe1a8\",\"#e26d5c\"), colsteps=length(x)) {\r\n  return( colorRampPalette(colors) (colsteps) [ findInterval(x, seq(min(x),max(x), length.out=colsteps)) ] )\r\n}\r\n\r\narcDiagram <- function(\r\n  edgelist, edgeweight=5, edgecol=5, edgeseq=1, cols=c(\"#c9cba3\",\"#ffe1a8\",\"#e26d5c\"), sorted=FALSE, decreasing=FALSE, lwd=NULL,\r\n  col=NULL, cex=NULL, col.nodes=NULL, lend=1, ljoin=2, lmitre=1,\r\n  las=2, bg=NULL, mar=c(4,1,3,1))\r\n{\r\n  # ARGUMENTS\r\n  # edgelist:   two-column matrix with edges\r\n  # sorted:     logical to indicate if nodes should be sorted\r\n  # decreasing: logical to indicate type of sorting (used only when sorted=TRUE)\r\n  # lwd:        widths for the arcs (default 1)\r\n  # col:        color for the arcs (default \"gray50\")\r\n  # cex:        magnification of the nodes labels (default 1)\r\n  # col.nodes:  color of the nodes labels (default \"gray50\")\r\n  # lend:       the line end style for the arcs (see par)\r\n  # ljoin:      the line join style for the arcs (see par)\r\n  # lmitre:     the line mitre limit fort the arcs (see par)\r\n  # las:        numeric in {0,1,2,3}; the style of axis labels (see par)\r\n  # bg:         background color (default \"white\")\r\n  # mar:        numeric vector for margins (see par)\r\n  \r\n  # make sure edgelist is a two-col matrix\r\n  if (!is.matrix(edgelist) || ncol(edgelist)!=2)\r\n    stop(\"argument 'edgelist' must be a two column matrix\")\r\n  \r\n  edges <- edgelist\r\n  print(edges)\r\n  #SORT EDGES\r\n  \r\n  edgecol <- as.data.frame(edgecol) %>% sapply(as.numeric)\r\n  edgeweight <- edgeweight %>% as.data.frame() %>% sapply(as.numeric)\r\n  if (length(edgeweight)==1) edgeweight = rep(edgeweight,nrow(edges))\r\n  if (length(edgecol)==1) edgecol = rep(edgecol,nrow(edges))\r\n  if (length(edgeseq)==1 & is.null(nrow(edgeseq))) edgeseq = 1:nrow(edges)\r\n  #colnames(edgeseq) <- 'edgeseq'\r\n  # edgesort <- cbind(edges,edgeseq,edgeweight,edgecol) %>% as.data.frame()\r\n  # edgesort <- edgesort %>%\r\n  #   left_join(edgesort[c('origin','edgeseq')], by = c(\"destination\" = \"origin\")) %>%\r\n  #   rename(from = edgeseq.x, to = edgeseq.y) %>% unique()\r\n  # #sort\r\n  # edgesort <- edgesort[with(edgesort, order(from,to)),]\r\n  # edges <- as.matrix(edgesort[1:2])\r\n  # \r\n  # edgeweight <- edgesort[4] %>% as.data.frame() %>% sapply(as.numeric)\r\n  # edgecol <- edgesort[5] %>% as.data.frame() %>% sapply(as.numeric)\r\n  # \r\n  \r\n  # Error handling\r\n  #check that the dataframe is not empty\r\n  if (length(edgeweight)==0) {\r\n    p <- plotly_empty() %>%  add_text(x=0,\r\n                                 y=0,\r\n                                 text = paste(\"Not enough data to produce plot,\",\"\\n\",\"change filters and try again.\"),\r\n                                 textfont = list(color = '#ff0000', size = 24, weight=\"bold\"))\r\n    internalSaveWidget(p, 'out.html');\r\n    quit()\r\n  }\r\n  \r\n  \r\n  # how many edges\r\n  ne = nrow(edges)\r\n  # get nodes\r\n  nodes = unique(as.vector(edges))\r\n  nums = unique(as.vector(edgeseq))\r\n  # how many nodes\r\n  nn = length(nodes) \r\n  # ennumerate\r\n  if (sorted) {\r\n    nodes = nodes[order(nums)]\r\n    # nums = order(nodes, decreasing=decreasing)\r\n  }\r\n  # check default argument values\r\n  if (is.null(lwd)) lwd = rep(1, ne)\r\n  if (length(lwd) != ne) lwd = rep(lwd, length=ne)\r\n  if (is.null(col)) col = rep(\"gray50\", ne)\r\n  if (length(col) != ne) col = rep(col, length=ne)\r\n  if (is.null(cex)) cex = rep(1, nn)\r\n  if (length(cex) != nn) cex = rep(cex, length=nn)\r\n  if (is.null(col.nodes)) col.nodes = rep(\"gray50\", nn)\r\n  if (length(col.nodes) != nn) col.nodes = rep(col.nodes, length=nn)\r\n  if (is.null(bg)) bg = \"white\"\r\n  wd <- edgeweight\r\n  # scale the weight\r\n  wd <- (wd-min(wd))/(max(wd)-min(wd))*10 +1\r\n  print(\"wd\")\r\n  print(str(wd))\r\n  wd.col <- color.gradient(edgecol,colors = cols)\r\n  # node labels coordinates\r\n  nf = rep(1 / nn, nn)\r\n  # node labels center coordinates\r\n  fin = cumsum(nf)\r\n  ini = c(0, cumsum(nf)[-nn])\r\n  centers = (ini + fin) / 2\r\n  names(centers) = nodes\r\n  # arcs coordinates\r\n  # matrix with numeric indices\r\n  e_num = matrix(0, nrow(edges), ncol(edges))\r\n  for (i in 1:nrow(edges))\r\n  {\r\n    e_num[i,1] = centers[which(nodes == edges[i,1])]\r\n    e_num[i,2] = centers[which(nodes == edges[i,2])]\r\n  }\r\n  # max arc radius\r\n  # multiply by -1 to flip arcs\r\n  radios = ((e_num[,1] - e_num[,2]) / 2) * -1\r\n  max_radios = which(radios == max(radios))\r\n  max_rad = unique(radios[max_radios] / 2)\r\n  min_radios = which(radios == min(radios))\r\n  min_rad = unique(radios[min_radios] / 2)\r\n  # arc locations\r\n  locs = rowSums(e_num) / 2\r\n  # plot\r\n  par(mar = mar, bg = bg)\r\n  # plot.new()\r\n  # plot.window(xlim=c(-0.025, 1.025), ylim=c(1*min_rad*2, 1*max_rad*2))\r\n  p <- plot_ly(x=locs,\r\n               y=0,\r\n               type='scatter',\r\n               mode = 'markers',\r\n               marker=list(size=1, opacity=0),\r\n               color=edgecol, \r\n               colors=color.gradient(1:length(cols),colors = cols),\r\n               hoverinfo = \"none\")\r\n  print(\"cols\")\r\n  print(cols)\r\n  print(color.gradient(1:length(cols),colors = cols))\r\n  # plot connecting arcs\r\n  z = seq(0, pi, l=100)\r\n  for (i in 1:nrow(edges))\r\n  {\r\n    #   radio = radios[i]\r\n    #   x = locs[i] + radio * cos(z)\r\n    #   y = radio * sin(z)\r\n    #   lines(x, y, col=col[i], lwd=lwd[i], \r\n    #         lend=lend, ljoin=ljoin, lmitre=lmitre)\r\n    radio = radios[i]\r\n    x = locs[i] + radio * cos(z)\r\n    y = radio * sin(z)\r\n    y = y + ifelse(y[[2]]>0,0.05,-0.01) #move y up/down to show label\r\n    width <- wd[i]\r\n    print(width)\r\n    color <- wd.col[i]\r\n    txt <- paste0(edges[i,1],\" to \",edges[i,2],\"\\n\",\r\n                  colnames(edgecol),\": \",format(edgecol[i],digits = 2),\"\\n\",\r\n                  colnames(edgeweight),\": \",format(edgeweight[i],digits = 2))\r\n    p <- add_trace(p,\r\n                   x = x,\r\n                   y = y, \r\n                   hoverinfo = \"text\",\r\n                   text = txt,\r\n                   line = list(color = color, shape = \"spline\", width = width),\r\n                   mode = \"lines+markers\",\r\n                   name = txt, \r\n                   type = \"scatter\")\r\n  }\r\n  \r\n  axis_template <- list(showgrid = F , zeroline = F, showline = F, showticklabels = F)\r\n  m <- list(l = 0, r = 0, b = 0, t = 0, pad = 0)\r\n  p <- p %>%  add_text(x=centers,\r\n                       y=0.03,\r\n                       text = paste0(substr(names(centers),1,4),\".\"),\r\n                       textfont = list(color = '#000000', size = 12, weight=\"bold\")) %>% \r\n    add_trace(\r\n      x = centers,\r\n      y = 0,\r\n      marker = list(\r\n        color = 'rgb(255, 255, 255)',\r\n        size = 15,\r\n        opacity=1,\r\n        line = list(\r\n          color = 'rgb(0, 0, 0)',\r\n          width = 2\r\n        )\r\n      ),\r\n      showlegend = F\r\n    ) %>%\r\n    # add_trace(x=centers,\r\n    #           y=0,\r\n    #           marker = list(\r\n    #             color = 'rgb(17, 157, 255)',\r\n    #             size = 20,\r\n    #             line = list(\r\n    #               color = 'rgb(231, 99, 250)',\r\n    #               width = 2\r\n    #             ))) %>%\r\n    layout(xaxis = axis_template,\r\n           yaxis = axis_template,\r\n           showlegend = F,\r\n           margin = m\r\n    )\r\n  #p\r\n  internalSaveWidget(p, 'out.html');\r\n}\r\n\r\n#Values <- edges\r\n\r\n#create default variables\r\nif (!exists(\"settings_cols_numCols\")) {settings_cols_numCols = \"5\";}\r\nif (!exists(\"settings_cols_col1\")) {settings_cols_col1 = \"#c7e9b4\";}\r\nif (!exists(\"settings_cols_col2\")) {settings_cols_col2 = \"#7fcdbb\";}\r\nif (!exists(\"settings_cols_col3\")) {settings_cols_col3 = \"#41b6c4\";}\r\nif (!exists(\"settings_cols_col4\")) {settings_cols_col4 = \"#2c7fb8\";}\r\nif (!exists(\"settings_cols_col5\")) {settings_cols_col5 = \"#253494\";}\r\n\r\nnumCols <- as.numeric(settings_cols_numCols)\r\n\r\ncols <- c(settings_cols_col1,settings_cols_col2,\r\n          settings_cols_col3,settings_cols_col4,\r\n          settings_cols_col5)\r\n\r\ncols <- cols[1:numCols]\r\n\r\narcDiagram(as.matrix(Values[1:2]), \r\n           edgeweight = Values[3],\r\n           edgecol = Values[4],\r\n           edgeseq = as.matrix(Values[5:6]),\r\n           cols = cols,\r\n           sorted = T)\r\n"}}}],"objects":{"rcv_script":{"properties":{"provider":{"type":{"text":true}},"source":{"type":{"scripting":{"source":true}}}}},"settings_cols":{"displayName":"Color Picker","description":"Select Gradient Colors","properties":{"numCols":{"displayName":"Number of Colors","description":"Choose to only use the first n colors","type":{"enumeration":[{"displayName":"1","value":"1"},{"displayName":"2","value":"2"},{"displayName":"3","value":"3"},{"displayName":"4","value":"4"},{"displayName":"5","value":"5"}]}},"col1":{"displayName":"Color 1","description":"Minimum color","type":{"fill":{"solid":{"color":true}}}},"col2":{"displayName":"Color 2","description":"Color 2","type":{"fill":{"solid":{"color":true}}}},"col3":{"displayName":"Color 3","description":"Color 3","type":{"fill":{"solid":{"color":true}}}},"col4":{"displayName":"Color 4","description":"Color 4","type":{"fill":{"solid":{"color":true}}}},"col5":{"displayName":"Color 5","description":"Maximum color","type":{"fill":{"solid":{"color":true}}}}}}},"suppressDefaultTitle":true},"dependencies":{"cranPackages":[{"name":"ggplot2","displayName":"GG Plot 2","url":"https://cran.r-project.org/web/packages/ggplot2/index.html"},{"name":"plotly","displayName":"Plotly","url":"https://cran.r-project.org/web/packages/plotly/index.html"},{"name":"htmlwidgets","displayName":"HTML Widgets","url":"https://cran.r-project.org/web/packages/htmlwidgets/index.html"},{"name":"XML","displayName":"XML","url":"https://cran.r-project.org/web/packages/XML/index.html"}]},"content":{"js":"\nvar globalPowerbi = powerbi;\n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// define __esModule on exports\n/******/ \t__webpack_require__.r = function(exports) {\n/******/ \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t};\n/******/\n/******/ \t// create a fake namespace object\n/******/ \t// mode & 1: value is a module id, require it\n/******/ \t// mode & 2: merge all properties of value into the ns\n/******/ \t// mode & 4: return value when already ns object\n/******/ \t// mode & 8|1: behave like require\n/******/ \t__webpack_require__.t = function(value, mode) {\n/******/ \t\tif(mode & 1) value = __webpack_require__(value);\n/******/ \t\tif(mode & 8) return value;\n/******/ \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n/******/ \t\tvar ns = Object.create(null);\n/******/ \t\t__webpack_require__.r(ns);\n/******/ \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n/******/ \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n/******/ \t\treturn ns;\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"assets\";\n/******/\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/* WEBPACK VAR INJECTION */(function(window) {/*\r\n *  Power BI Visualizations\r\n *\r\n *  Copyright (c) Microsoft Corporation\r\n *  All rights reserved.\r\n *  MIT License\r\n *\r\n *  Permission is hereby granted, free of charge, to any person obtaining a copy\r\n *  of this software and associated documentation files (the \"\"Software\"\"), to deal\r\n *  in the Software without restriction, including without limitation the rights\r\n *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n *  copies of the Software, and to permit persons to whom the Software is\r\n *  furnished to do so, subject to the following conditions:\r\n *\r\n *  The above copyright notice and this permission notice shall be included in\r\n *  all copies or substantial portions of the Software.\r\n *\r\n *  THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n *  THE SOFTWARE.\r\n */\r\nvar powerbi;\r\n(function (powerbi) {\r\n    var extensibility;\r\n    (function (extensibility) {\r\n        var utils;\r\n        (function (utils) {\r\n            var dataview;\r\n            (function (dataview) {\r\n                // TODO: refactor & focus DataViewTransform into a service with well-defined dependencies.\r\n                var DataViewTransform;\r\n                (function (DataViewTransform) {\r\n                    // TODO: refactor this, setGrouped, and groupValues to a test helper to stop using it in the product\r\n                    function createValueColumns(values, valueIdentityFields, source) {\r\n                        if (values === void 0) { values = []; }\r\n                        var result = values;\r\n                        setGrouped(result);\r\n                        if (valueIdentityFields) {\r\n                            result.identityFields = valueIdentityFields;\r\n                        }\r\n                        if (source) {\r\n                            result.source = source;\r\n                        }\r\n                        return result;\r\n                    }\r\n                    DataViewTransform.createValueColumns = createValueColumns;\r\n                    function setGrouped(values, groupedResult) {\r\n                        values.grouped = groupedResult\r\n                            ? function () { return groupedResult; }\r\n                            : function () { return groupValues(values); };\r\n                    }\r\n                    DataViewTransform.setGrouped = setGrouped;\r\n                    /** Group together the values with a common identity. */\r\n                    function groupValues(values) {\r\n                        var groups = [], currentGroup;\r\n                        for (var i = 0, len = values.length; i < len; i++) {\r\n                            var value = values[i];\r\n                            if (!currentGroup || currentGroup.identity !== value.identity) {\r\n                                currentGroup = {\r\n                                    values: []\r\n                                };\r\n                                if (value.identity) {\r\n                                    currentGroup.identity = value.identity;\r\n                                    var source = value.source;\r\n                                    // allow null, which will be formatted as (Blank).\r\n                                    if (source.groupName !== undefined) {\r\n                                        currentGroup.name = source.groupName;\r\n                                    }\r\n                                    else if (source.displayName) {\r\n                                        currentGroup.name = source.displayName;\r\n                                    }\r\n                                }\r\n                                groups.push(currentGroup);\r\n                            }\r\n                            currentGroup.values.push(value);\r\n                        }\r\n                        return groups;\r\n                    }\r\n                    DataViewTransform.groupValues = groupValues;\r\n                })(DataViewTransform = dataview.DataViewTransform || (dataview.DataViewTransform = {}));\r\n            })(dataview = utils.dataview || (utils.dataview = {}));\r\n        })(utils = extensibility.utils || (extensibility.utils = {}));\r\n    })(extensibility = powerbi.extensibility || (powerbi.extensibility = {}));\r\n})(powerbi || (powerbi = {}));\r\n/*\r\n *  Power BI Visualizations\r\n *\r\n *  Copyright (c) Microsoft Corporation\r\n *  All rights reserved.\r\n *  MIT License\r\n *\r\n *  Permission is hereby granted, free of charge, to any person obtaining a copy\r\n *  of this software and associated documentation files (the \"\"Software\"\"), to deal\r\n *  in the Software without restriction, including without limitation the rights\r\n *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n *  copies of the Software, and to permit persons to whom the Software is\r\n *  furnished to do so, subject to the following conditions:\r\n *\r\n *  The above copyright notice and this permission notice shall be included in\r\n *  all copies or substantial portions of the Software.\r\n *\r\n *  THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n *  THE SOFTWARE.\r\n */\r\nvar powerbi;\r\n(function (powerbi) {\r\n    var extensibility;\r\n    (function (extensibility) {\r\n        var utils;\r\n        (function (utils) {\r\n            var dataview;\r\n            (function (dataview) {\r\n                var DataRoleHelper;\r\n                (function (DataRoleHelper) {\r\n                    function getMeasureIndexOfRole(grouped, roleName) {\r\n                        if (!grouped || !grouped.length) {\r\n                            return -1;\r\n                        }\r\n                        var firstGroup = grouped[0];\r\n                        if (firstGroup.values && firstGroup.values.length > 0) {\r\n                            for (var i = 0, len = firstGroup.values.length; i < len; ++i) {\r\n                                var value = firstGroup.values[i];\r\n                                if (value && value.source) {\r\n                                    if (hasRole(value.source, roleName)) {\r\n                                        return i;\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                        return -1;\r\n                    }\r\n                    DataRoleHelper.getMeasureIndexOfRole = getMeasureIndexOfRole;\r\n                    function getCategoryIndexOfRole(categories, roleName) {\r\n                        if (categories && categories.length) {\r\n                            for (var i = 0, ilen = categories.length; i < ilen; i++) {\r\n                                if (hasRole(categories[i].source, roleName)) {\r\n                                    return i;\r\n                                }\r\n                            }\r\n                        }\r\n                        return -1;\r\n                    }\r\n                    DataRoleHelper.getCategoryIndexOfRole = getCategoryIndexOfRole;\r\n                    function hasRole(column, name) {\r\n                        var roles = column.roles;\r\n                        return roles && roles[name];\r\n                    }\r\n                    DataRoleHelper.hasRole = hasRole;\r\n                    function hasRoleInDataView(dataView, name) {\r\n                        return dataView != null\r\n                            && dataView.metadata != null\r\n                            && dataView.metadata.columns\r\n                            && dataView.metadata.columns.some(function (c) { return c.roles && c.roles[name] !== undefined; }); // any is an alias of some\r\n                    }\r\n                    DataRoleHelper.hasRoleInDataView = hasRoleInDataView;\r\n                    function hasRoleInValueColumn(valueColumn, name) {\r\n                        return valueColumn\r\n                            && valueColumn.source\r\n                            && valueColumn.source.roles\r\n                            && (valueColumn.source.roles[name] === true);\r\n                    }\r\n                    DataRoleHelper.hasRoleInValueColumn = hasRoleInValueColumn;\r\n                })(DataRoleHelper = dataview.DataRoleHelper || (dataview.DataRoleHelper = {}));\r\n            })(dataview = utils.dataview || (utils.dataview = {}));\r\n        })(utils = extensibility.utils || (extensibility.utils = {}));\r\n    })(extensibility = powerbi.extensibility || (powerbi.extensibility = {}));\r\n})(powerbi || (powerbi = {}));\r\n/*\r\n *  Power BI Visualizations\r\n *\r\n *  Copyright (c) Microsoft Corporation\r\n *  All rights reserved.\r\n *  MIT License\r\n *\r\n *  Permission is hereby granted, free of charge, to any person obtaining a copy\r\n *  of this software and associated documentation files (the \"\"Software\"\"), to deal\r\n *  in the Software without restriction, including without limitation the rights\r\n *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n *  copies of the Software, and to permit persons to whom the Software is\r\n *  furnished to do so, subject to the following conditions:\r\n *\r\n *  The above copyright notice and this permission notice shall be included in\r\n *  all copies or substantial portions of the Software.\r\n *\r\n *  THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n *  THE SOFTWARE.\r\n */\r\nvar powerbi;\r\n(function (powerbi) {\r\n    var extensibility;\r\n    (function (extensibility) {\r\n        var utils;\r\n        (function (utils) {\r\n            var dataview;\r\n            (function (dataview) {\r\n                var DataViewObject;\r\n                (function (DataViewObject) {\r\n                    function getValue(object, propertyName, defaultValue) {\r\n                        if (!object) {\r\n                            return defaultValue;\r\n                        }\r\n                        var propertyValue = object[propertyName];\r\n                        if (propertyValue === undefined) {\r\n                            return defaultValue;\r\n                        }\r\n                        return propertyValue;\r\n                    }\r\n                    DataViewObject.getValue = getValue;\r\n                    /** Gets the solid color from a fill property using only a propertyName */\r\n                    function getFillColorByPropertyName(object, propertyName, defaultColor) {\r\n                        var value = getValue(object, propertyName);\r\n                        if (!value || !value.solid) {\r\n                            return defaultColor;\r\n                        }\r\n                        return value.solid.color;\r\n                    }\r\n                    DataViewObject.getFillColorByPropertyName = getFillColorByPropertyName;\r\n                })(DataViewObject = dataview.DataViewObject || (dataview.DataViewObject = {}));\r\n            })(dataview = utils.dataview || (utils.dataview = {}));\r\n        })(utils = extensibility.utils || (extensibility.utils = {}));\r\n    })(extensibility = powerbi.extensibility || (powerbi.extensibility = {}));\r\n})(powerbi || (powerbi = {}));\r\n/*\r\n *  Power BI Visualizations\r\n *\r\n *  Copyright (c) Microsoft Corporation\r\n *  All rights reserved.\r\n *  MIT License\r\n *\r\n *  Permission is hereby granted, free of charge, to any person obtaining a copy\r\n *  of this software and associated documentation files (the \"\"Software\"\"), to deal\r\n *  in the Software without restriction, including without limitation the rights\r\n *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n *  copies of the Software, and to permit persons to whom the Software is\r\n *  furnished to do so, subject to the following conditions:\r\n *\r\n *  The above copyright notice and this permission notice shall be included in\r\n *  all copies or substantial portions of the Software.\r\n *\r\n *  THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n *  THE SOFTWARE.\r\n */\r\nvar powerbi;\r\n(function (powerbi) {\r\n    var extensibility;\r\n    (function (extensibility) {\r\n        var utils;\r\n        (function (utils) {\r\n            var dataview;\r\n            (function (dataview) {\r\n                var DataViewObjects;\r\n                (function (DataViewObjects) {\r\n                    /** Gets the value of the given object/property pair. */\r\n                    function getValue(objects, propertyId, defaultValue) {\r\n                        if (!objects) {\r\n                            return defaultValue;\r\n                        }\r\n                        return dataview.DataViewObject.getValue(objects[propertyId.objectName], propertyId.propertyName, defaultValue);\r\n                    }\r\n                    DataViewObjects.getValue = getValue;\r\n                    /** Gets an object from objects. */\r\n                    function getObject(objects, objectName, defaultValue) {\r\n                        if (objects && objects[objectName]) {\r\n                            return objects[objectName];\r\n                        }\r\n                        return defaultValue;\r\n                    }\r\n                    DataViewObjects.getObject = getObject;\r\n                    /** Gets the solid color from a fill property. */\r\n                    function getFillColor(objects, propertyId, defaultColor) {\r\n                        var value = getValue(objects, propertyId);\r\n                        if (!value || !value.solid) {\r\n                            return defaultColor;\r\n                        }\r\n                        return value.solid.color;\r\n                    }\r\n                    DataViewObjects.getFillColor = getFillColor;\r\n                    function getCommonValue(objects, propertyId, defaultValue) {\r\n                        var value = getValue(objects, propertyId, defaultValue);\r\n                        if (value && value.solid) {\r\n                            return value.solid.color;\r\n                        }\r\n                        if (value === undefined\r\n                            || value === null\r\n                            || (typeof value === \"object\" && !value.solid)) {\r\n                            return defaultValue;\r\n                        }\r\n                        return value;\r\n                    }\r\n                    DataViewObjects.getCommonValue = getCommonValue;\r\n                })(DataViewObjects = dataview.DataViewObjects || (dataview.DataViewObjects = {}));\r\n            })(dataview = utils.dataview || (utils.dataview = {}));\r\n        })(utils = extensibility.utils || (extensibility.utils = {}));\r\n    })(extensibility = powerbi.extensibility || (powerbi.extensibility = {}));\r\n})(powerbi || (powerbi = {}));\r\n/*\r\n *  Power BI Visualizations\r\n *\r\n *  Copyright (c) Microsoft Corporation\r\n *  All rights reserved.\r\n *  MIT License\r\n *\r\n *  Permission is hereby granted, free of charge, to any person obtaining a copy\r\n *  of this software and associated documentation files (the \"\"Software\"\"), to deal\r\n *  in the Software without restriction, including without limitation the rights\r\n *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n *  copies of the Software, and to permit persons to whom the Software is\r\n *  furnished to do so, subject to the following conditions:\r\n *\r\n *  The above copyright notice and this permission notice shall be included in\r\n *  all copies or substantial portions of the Software.\r\n *\r\n *  THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n *  THE SOFTWARE.\r\n */\r\nvar powerbi;\r\n(function (powerbi) {\r\n    var extensibility;\r\n    (function (extensibility) {\r\n        var utils;\r\n        (function (utils) {\r\n            var dataview;\r\n            (function (dataview) {\r\n                // powerbi.extensibility.utils.dataview\r\n                var DataRoleHelper = powerbi.extensibility.utils.dataview.DataRoleHelper;\r\n                var converterHelper;\r\n                (function (converterHelper) {\r\n                    function categoryIsAlsoSeriesRole(dataView, seriesRoleName, categoryRoleName) {\r\n                        if (dataView.categories && dataView.categories.length > 0) {\r\n                            // Need to pivot data if our category soure is a series role\r\n                            var category = dataView.categories[0];\r\n                            return category.source &&\r\n                                DataRoleHelper.hasRole(category.source, seriesRoleName) &&\r\n                                DataRoleHelper.hasRole(category.source, categoryRoleName);\r\n                        }\r\n                        return false;\r\n                    }\r\n                    converterHelper.categoryIsAlsoSeriesRole = categoryIsAlsoSeriesRole;\r\n                    function getSeriesName(source) {\r\n                        return (source.groupName !== undefined)\r\n                            ? source.groupName\r\n                            : source.queryName;\r\n                    }\r\n                    converterHelper.getSeriesName = getSeriesName;\r\n                    function isImageUrlColumn(column) {\r\n                        var misc = getMiscellaneousTypeDescriptor(column);\r\n                        return misc != null && misc.imageUrl === true;\r\n                    }\r\n                    converterHelper.isImageUrlColumn = isImageUrlColumn;\r\n                    function isWebUrlColumn(column) {\r\n                        var misc = getMiscellaneousTypeDescriptor(column);\r\n                        return misc != null && misc.webUrl === true;\r\n                    }\r\n                    converterHelper.isWebUrlColumn = isWebUrlColumn;\r\n                    function getMiscellaneousTypeDescriptor(column) {\r\n                        return column\r\n                            && column.type\r\n                            && column.type.misc;\r\n                    }\r\n                    converterHelper.getMiscellaneousTypeDescriptor = getMiscellaneousTypeDescriptor;\r\n                    function hasImageUrlColumn(dataView) {\r\n                        if (!dataView || !dataView.metadata || !dataView.metadata.columns || !dataView.metadata.columns.length) {\r\n                            return false;\r\n                        }\r\n                        return dataView.metadata.columns.some(function (column) { return isImageUrlColumn(column) === true; });\r\n                    }\r\n                    converterHelper.hasImageUrlColumn = hasImageUrlColumn;\r\n                })(converterHelper = dataview.converterHelper || (dataview.converterHelper = {}));\r\n            })(dataview = utils.dataview || (utils.dataview = {}));\r\n        })(utils = extensibility.utils || (extensibility.utils = {}));\r\n    })(extensibility = powerbi.extensibility || (powerbi.extensibility = {}));\r\n})(powerbi || (powerbi = {}));\r\n/*\r\n *  Power BI Visualizations\r\n *\r\n *  Copyright (c) Microsoft Corporation\r\n *  All rights reserved.\r\n *  MIT License\r\n *\r\n *  Permission is hereby granted, free of charge, to any person obtaining a copy\r\n *  of this software and associated documentation files (the \"\"Software\"\"), to deal\r\n *  in the Software without restriction, including without limitation the rights\r\n *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n *  copies of the Software, and to permit persons to whom the Software is\r\n *  furnished to do so, subject to the following conditions:\r\n *\r\n *  The above copyright notice and this permission notice shall be included in\r\n *  all copies or substantial portions of the Software.\r\n *\r\n *  THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n *  THE SOFTWARE.\r\n */\r\nvar powerbi;\r\n(function (powerbi) {\r\n    var extensibility;\r\n    (function (extensibility) {\r\n        var utils;\r\n        (function (utils) {\r\n            var dataview;\r\n            (function (dataview) {\r\n                var DataViewObjectsParser = (function () {\r\n                    function DataViewObjectsParser() {\r\n                    }\r\n                    DataViewObjectsParser.getDefault = function () {\r\n                        return new this();\r\n                    };\r\n                    DataViewObjectsParser.createPropertyIdentifier = function (objectName, propertyName) {\r\n                        return {\r\n                            objectName: objectName,\r\n                            propertyName: propertyName\r\n                        };\r\n                    };\r\n                    DataViewObjectsParser.parse = function (dataView) {\r\n                        var dataViewObjectParser = this.getDefault(), properties;\r\n                        if (!dataView || !dataView.metadata || !dataView.metadata.objects) {\r\n                            return dataViewObjectParser;\r\n                        }\r\n                        properties = dataViewObjectParser.getProperties();\r\n                        for (var objectName in properties) {\r\n                            for (var propertyName in properties[objectName]) {\r\n                                var defaultValue = dataViewObjectParser[objectName][propertyName];\r\n                                dataViewObjectParser[objectName][propertyName] = dataview.DataViewObjects.getCommonValue(dataView.metadata.objects, properties[objectName][propertyName], defaultValue);\r\n                            }\r\n                        }\r\n                        return dataViewObjectParser;\r\n                    };\r\n                    DataViewObjectsParser.isPropertyEnumerable = function (propertyName) {\r\n                        return !DataViewObjectsParser.InnumerablePropertyPrefix.test(propertyName);\r\n                    };\r\n                    DataViewObjectsParser.enumerateObjectInstances = function (dataViewObjectParser, options) {\r\n                        var dataViewProperties = dataViewObjectParser && dataViewObjectParser[options.objectName];\r\n                        if (!dataViewProperties) {\r\n                            return [];\r\n                        }\r\n                        var instance = {\r\n                            objectName: options.objectName,\r\n                            selector: null,\r\n                            properties: {}\r\n                        };\r\n                        for (var key in dataViewProperties) {\r\n                            if (dataViewProperties.hasOwnProperty(key)) {\r\n                                instance.properties[key] = dataViewProperties[key];\r\n                            }\r\n                        }\r\n                        return {\r\n                            instances: [instance]\r\n                        };\r\n                    };\r\n                    DataViewObjectsParser.prototype.getProperties = function () {\r\n                        var _this = this;\r\n                        var properties = {}, objectNames = Object.keys(this);\r\n                        objectNames.forEach(function (objectName) {\r\n                            if (DataViewObjectsParser.isPropertyEnumerable(objectName)) {\r\n                                var propertyNames = Object.keys(_this[objectName]);\r\n                                properties[objectName] = {};\r\n                                propertyNames.forEach(function (propertyName) {\r\n                                    if (DataViewObjectsParser.isPropertyEnumerable(objectName)) {\r\n                                        properties[objectName][propertyName] =\r\n                                            DataViewObjectsParser.createPropertyIdentifier(objectName, propertyName);\r\n                                    }\r\n                                });\r\n                            }\r\n                        });\r\n                        return properties;\r\n                    };\r\n                    return DataViewObjectsParser;\r\n                }());\r\n                DataViewObjectsParser.InnumerablePropertyPrefix = /^_/;\r\n                dataview.DataViewObjectsParser = DataViewObjectsParser;\r\n            })(dataview = utils.dataview || (utils.dataview = {}));\r\n        })(utils = extensibility.utils || (extensibility.utils = {}));\r\n    })(extensibility = powerbi.extensibility || (powerbi.extensibility = {}));\r\n})(powerbi || (powerbi = {}));\r\n\nvar powerbi;\r\n(function (powerbi) {\r\n    var extensibility;\r\n    (function (extensibility) {\r\n        var visual;\r\n        (function (visual) {\r\n            \"use strict\";\r\n            let injectorCounter = 0;\r\n            function ResetInjector() {\r\n                injectorCounter = 0;\r\n            }\r\n            visual.ResetInjector = ResetInjector;\r\n            function injectorReady() {\r\n                return injectorCounter === 0;\r\n            }\r\n            visual.injectorReady = injectorReady;\r\n            function ParseElement(el, target) {\r\n                let arr = [];\r\n                if (!el || !el.hasChildNodes()) {\r\n                    return;\r\n                }\r\n                let nodes = el.children;\r\n                for (let i = 0; i < nodes.length; i++) {\r\n                    let tempNode;\r\n                    if (nodes.item(i).nodeName.toLowerCase() === \"script\") {\r\n                        tempNode = createScriptNode(nodes.item(i));\r\n                    }\r\n                    else {\r\n                        tempNode = nodes.item(i).cloneNode(true);\r\n                    }\r\n                    target.appendChild(tempNode);\r\n                    arr.push(tempNode);\r\n                }\r\n                return arr;\r\n            }\r\n            visual.ParseElement = ParseElement;\r\n            function createScriptNode(refNode) {\r\n                let script = document.createElement(\"script\");\r\n                let attr = refNode.attributes;\r\n                for (let i = 0; i < attr.length; i++) {\r\n                    script.setAttribute(attr[i].name, attr[i].textContent);\r\n                    if (attr[i].name.toLowerCase() === \"src\") {\r\n                        // waiting only for src to finish loading - async opetation\r\n                        injectorCounter++;\r\n                        script.onload = () => {\r\n                            injectorCounter--;\r\n                        };\r\n                    }\r\n                }\r\n                script.innerHTML = refNode.innerHTML;\r\n                return script;\r\n            }\r\n            function RunHTMLWidgetRenderer() {\r\n                // rendering HTML which was created by HTMLWidgets package\r\n                // wait till all tje script elements are loaded\r\n                let intervalVar = window.setInterval(() => {\r\n                    if (injectorReady()) {\r\n                        window.clearInterval(intervalVar);\r\n                        if (window.hasOwnProperty(\"HTMLWidgets\") && window[\"HTMLWidgets\"].staticRender) {\r\n                            window[\"HTMLWidgets\"].staticRender();\r\n                        }\r\n                    }\r\n                }, 100);\r\n            }\r\n            visual.RunHTMLWidgetRenderer = RunHTMLWidgetRenderer;\r\n        })(visual = extensibility.visual || (extensibility.visual = {}));\r\n    })(extensibility = powerbi.extensibility || (powerbi.extensibility = {}));\r\n})(powerbi || (powerbi = {}));\r\n/*\r\n *  Power BI Visualizations\r\n *\r\n *  Copyright (c) Microsoft Corporation\r\n *  All rights reserved.\r\n *  MIT License\r\n *\r\n *  Permission is hereby granted, free of charge, to any person obtaining a copy\r\n *  of this software and associated documentation files (the \"\"Software\"\"), to deal\r\n *  in the Software without restriction, including without limitation the rights\r\n *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n *  copies of the Software, and to permit persons to whom the Software is\r\n *  furnished to do so, subject to the following conditions:\r\n *\r\n *  The above copyright notice and this permission notice shall be included in\r\n *  all copies or substantial portions of the Software.\r\n *\r\n *  THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n *  THE SOFTWARE.\r\n */\r\nvar powerbi;\r\n(function (powerbi) {\r\n    var extensibility;\r\n    (function (extensibility) {\r\n        var visual;\r\n        (function (visual) {\r\n            \"use strict\";\r\n            var DataViewObjectsParser = powerbi.extensibility.utils.dataview.DataViewObjectsParser;\r\n            class VisualSettings extends DataViewObjectsParser {\r\n                constructor() {\r\n                    super(...arguments);\r\n                    this.rcv_script = new rcv_scriptSettings();\r\n                }\r\n            }\r\n            visual.VisualSettings = VisualSettings;\r\n            class rcv_scriptSettings {\r\n            }\r\n            visual.rcv_scriptSettings = rcv_scriptSettings;\r\n        })(visual = extensibility.visual || (extensibility.visual = {}));\r\n    })(extensibility = powerbi.extensibility || (powerbi.extensibility = {}));\r\n})(powerbi || (powerbi = {}));\r\nvar powerbi;\r\n(function (powerbi) {\r\n    var extensibility;\r\n    (function (extensibility) {\r\n        var visual;\r\n        (function (visual) {\r\n            \"use strict\";\r\n            // below is a snippet of a definition for an object which will contain the property values\r\n            // selected by the users\r\n            /*interface VisualSettings {\r\n                lineColor: string;\r\n            }*/\r\n            // to allow this scenario you should first the following JSON definition to the capabilities.json file\r\n            // under the \"objects\" property:\r\n            // \"settings\": {\r\n            //     \"displayName\": \"Visual Settings\",\r\n            //     \"description\": \"Visual Settings Tooltip\",\r\n            //     \"properties\": {\r\n            //         \"lineColor\": {\r\n            //         \"displayName\": \"Line Color\",\r\n            //         \"type\": { \"fill\": { \"solid\": { \"color\": true }}}\r\n            //         }\r\n            //     }\r\n            // }\r\n            // powerbi.extensibility.utils.dataview\r\n            var DataViewObjectsModule = powerbi.extensibility.utils.dataview.DataViewObject;\r\n            // in order to improve the performance, one can update the <head> only in the initial rendering.\r\n            // set to 'true' if you are using different packages to create the widgets\r\n            const updateHTMLHead = false;\r\n            const renderVisualUpdateType = [\r\n                powerbi.VisualUpdateType.Resize,\r\n                powerbi.VisualUpdateType.ResizeEnd,\r\n                powerbi.VisualUpdateType.Resize + powerbi.VisualUpdateType.ResizeEnd\r\n            ];\r\n            //RVIZ_IN_PBI_GUIDE:END:Added to create HTML-based \r\n            class Visual {\r\n                //RVIZ_IN_PBI_GUIDE:END:Added to create HTML-based \r\n                constructor(options) {\r\n                    if (options && options.element) {\r\n                        this.rootElement = options.element;\r\n                    }\r\n                    this.headNodes = [];\r\n                    this.bodyNodes = [];\r\n                    //RVIZ_IN_PBI_GUIDE:BEGIN:Added to create HTML-based \r\n                    this.settings_cols = {\r\n                        numCols: \"5\",\r\n                        col1: \"#c7e9b4\",\r\n                        col2: \"#7fcdbb\",\r\n                        col3: \"#41b6c4\",\r\n                        col4: \"#2c7fb8\",\r\n                        col5: \"#253494\"\r\n                    };\r\n                    //RVIZ_IN_PBI_GUIDE:END:Added to create HTML-based \r\n                }\r\n                update(options) {\r\n                    if (!options ||\r\n                        !options.type ||\r\n                        !options.viewport ||\r\n                        !options.dataViews ||\r\n                        options.dataViews.length === 0 ||\r\n                        !options.dataViews[0]) {\r\n                        return;\r\n                    }\r\n                    const dataView = options.dataViews[0];\r\n                    this.settings = Visual.parseSettings(dataView);\r\n                    //RVIZ_IN_PBI_GUIDE:BEGIN:Added to create HTML-based \r\n                    this.updateObjects(dataView.metadata.objects);\r\n                    //RVIZ_IN_PBI_GUIDE:END:Added to create HTML-based \r\n                    let payloadBase64 = null;\r\n                    if (dataView.scriptResult && dataView.scriptResult.payloadBase64) {\r\n                        payloadBase64 = dataView.scriptResult.payloadBase64;\r\n                    }\r\n                    if (renderVisualUpdateType.indexOf(options.type) === -1) {\r\n                        if (payloadBase64) {\r\n                            this.injectCodeFromPayload(payloadBase64);\r\n                        }\r\n                    }\r\n                    else {\r\n                        this.onResizing(options.viewport);\r\n                    }\r\n                }\r\n                onResizing(finalViewport) {\r\n                    /* add code to handle resizing of the view port */\r\n                }\r\n                injectCodeFromPayload(payloadBase64) {\r\n                    // inject HTML from payload, created in R\r\n                    // the code is injected to the 'head' and 'body' sections.\r\n                    // if the visual was already rendered, the previous DOM elements are cleared\r\n                    visual.ResetInjector();\r\n                    if (!payloadBase64) {\r\n                        return;\r\n                    }\r\n                    // create 'virtual' HTML, so parsing is easier\r\n                    let el = document.createElement(\"html\");\r\n                    try {\r\n                        el.innerHTML = window.atob(payloadBase64);\r\n                    }\r\n                    catch (err) {\r\n                        return;\r\n                    }\r\n                    // if 'updateHTMLHead == false', then the code updates the header data only on the 1st rendering\r\n                    // this option allows loading and parsing of large and recurring scripts only once.\r\n                    if (updateHTMLHead || this.headNodes.length === 0) {\r\n                        while (this.headNodes.length > 0) {\r\n                            let tempNode = this.headNodes.pop();\r\n                            document.head.removeChild(tempNode);\r\n                        }\r\n                        let headList = el.getElementsByTagName(\"head\");\r\n                        if (headList && headList.length > 0) {\r\n                            let head = headList[0];\r\n                            this.headNodes = visual.ParseElement(head, document.head);\r\n                        }\r\n                    }\r\n                    // update 'body' nodes, under the rootElement\r\n                    while (this.bodyNodes.length > 0) {\r\n                        let tempNode = this.bodyNodes.pop();\r\n                        this.rootElement.removeChild(tempNode);\r\n                    }\r\n                    let bodyList = el.getElementsByTagName(\"body\");\r\n                    if (bodyList && bodyList.length > 0) {\r\n                        let body = bodyList[0];\r\n                        this.bodyNodes = visual.ParseElement(body, this.rootElement);\r\n                    }\r\n                    visual.RunHTMLWidgetRenderer();\r\n                }\r\n                static parseSettings(dataView) {\r\n                    return visual.VisualSettings.parse(dataView);\r\n                }\r\n                //RVIZ_IN_PBI_GUIDE:BEGIN:Added to create HTML-based \r\n                /**\r\n                 * This function gets called by the update function above. You should read the new values of the properties into\r\n                 * your settings object so you can use the new value in the enumerateObjectInstances function below.\r\n                 *\r\n                 * Below is a code snippet demonstrating how to expose a single property called \"lineColor\" from the object called \"settings\"\r\n                 * This object and property should be first defined in the capabilities.json file in the objects section.\r\n                 * In this code we get the property value from the objects (and have a default value in case the property is undefined)\r\n                 */\r\n                updateObjects(objects) {\r\n                    this.settings_cols = {\r\n                        numCols: DataViewObjectsModule.getValue(objects, 'numCols', this.settings_cols.numCols),\r\n                        col1: DataViewObjectsModule.getValue(objects, 'col1', this.settings_cols.col1),\r\n                        col2: DataViewObjectsModule.getValue(objects, 'col2', this.settings_cols.col2),\r\n                        col3: DataViewObjectsModule.getValue(objects, 'col3', this.settings_cols.col3),\r\n                        col4: DataViewObjectsModule.getValue(objects, 'col4', this.settings_cols.col4),\r\n                        col5: DataViewObjectsModule.getValue(objects, 'col5', this.settings_cols.col5)\r\n                    };\r\n                }\r\n                //RVIZ_IN_PBI_GUIDE:END:Added to create HTML-based \r\n                /**\r\n                 * This function gets called for each of the objects defined in the capabilities files and allows you to select which of the\r\n                 * objects and properties you want to expose to the users in the property pane.\r\n                 *\r\n                 */\r\n                enumerateObjectInstances(options) {\r\n                    //RVIZ_IN_PBI_GUIDE:BEGIN:Added to create HTML-based \r\n                    let objectName = options.objectName;\r\n                    let objectEnumeration = [];\r\n                    switch (objectName) {\r\n                        case 'settings_cols':\r\n                            objectEnumeration.push({\r\n                                objectName: objectName,\r\n                                properties: {\r\n                                    numCols: this.settings_cols.numCols,\r\n                                    col1: this.settings_cols.col1,\r\n                                    col2: this.settings_cols.col2,\r\n                                    col3: this.settings_cols.col3,\r\n                                    col4: this.settings_cols.col4,\r\n                                    col5: this.settings_cols.col5\r\n                                },\r\n                                selector: null\r\n                            });\r\n                            break;\r\n                    }\r\n                    ;\r\n                    //RVIZ_IN_PBI_GUIDE:END:Added to create HTML-based \r\n                    return objectEnumeration;\r\n                }\r\n            }\r\n            visual.Visual = Visual;\r\n        })(visual = extensibility.visual || (extensibility.visual = {}));\r\n    })(extensibility = powerbi.extensibility || (powerbi.extensibility = {}));\r\n})(powerbi || (powerbi = {}));\r\npowerbi.visuals = powerbi.visuals || {};\r\npowerbi.visuals.plugins = powerbi.visuals.plugins || {};\r\npowerbi.visuals.plugins[\"arcDiagram3AE23BF6D2F64FC8B1ACABEBAD0FAE26_DEBUG\"] = {\r\n    name: 'arcDiagram3AE23BF6D2F64FC8B1ACABEBAD0FAE26_DEBUG',\r\n    displayName: 'arcDiagram',\r\n    class: 'Visual',\r\n    version: '1.0.0',\r\n    apiVersion: '1.13.0',\r\n    create: (options) => new powerbi.extensibility.visual.Visual(options),\r\n    custom: true\r\n};\r\n//# sourceMappingURL=visual.js.map\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(1)))\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\nmodule.exports = Function('return this')();\n\n/***/ })\n/******/ ]);\n//# sourceMappingURL=visual.js.map","css":".rcv_autoScaleImageContainer {\n  position: relative;\n}\n.rcv_autoScaleImageContainer .rcv_autoScaleImage {\n  max-width: 100%;\n  max-height: 100%;\n  position: absolute;\n  top: 50%;\n  /* @noflip */\n  left: 50%;\n  transform: translateY(-50%) translateX(-50%);\n  -webkit-transform: translateY(-50%) translateX(-50%);\n}\n","iconBase64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3NEY1QjA1NUQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3NEY1QjA1NEQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5Mjk5RDU1ODBGRDRFMDExQTcxQ0JFODI3ODBCQUE5RSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PpDoNX0AAAI3SURBVHjarJRLSFVRFIY9t7SiRDGLoEEPCRJRaCSYkxCiFCXCF+LIMExQLkilgumgwkbdBuWDRC2EomhURCOjgagkXEgKLUKhidobM6H0+i34rxyPnuvEA5/rXPda/1l7739vJxKJxG3ls93+hEKhTILxJhgMftmsiPxdhHw4CfepeR8dCyjWwwB0kZy3iVgCoQ2ewnmXxhrBD7Cgr/ZQVA17fDRPw2UYhzK6G99IsBse6/0QNME+H8FT4EA/YiPqOgA1q4IMzBNuw6iKjkCpj+Av+AdnEEmD3bxfhzvuDk30HaEaLsEkXCO53rN+Bwg5qsvTuj/TjGYtx9nINhRmEx7AYWiFW7AXOuEcbPOUvIZ2mnrl+PkQUbNEh4QHNKUSDdsSBWEOlmxTEfvs26FL9Khe211if6Acgee+xo7xzMgBxfq9qPe3fgWBGN2lEnqtG9nExM7CV3jp3bDos2bKJB0nHFRxAxRpA/5CIXyHh5ABv6GZqd9dJ6iz2SjbxMMypGhJFtTlNzu3kK7xgDxpove8U66FK2A+s6nul5gVVMEL+Ak7lG/T+g9JcIOGar2CRUoogxMwpP/bLTJMB9bRhDbkk5bBUU0y3ES0xS04CBfN9RSHiY90vJK0BHaSzG9h2eejS3RJeVfdtrGzuGyd8CX7Yq6ExuCH63jaVMPkFOv6OibB6DKs2+VEQp+WYBoqERn2sVWWRNN0YurIfeL14U6YkpkLYCSG6e0yqdCxvKBLIm5FgAEAV0nKuwMYRUsAAAAASUVORK5CYII="},"visualEntryPoint":""}